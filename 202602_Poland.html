<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>徐先生/蔡小姐 - 波蘭10日歷史文化之旅 (最終版)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        /* 自訂樣式，確保時間軸線條 */
        .timeline-line {
            position: absolute;
            left: 1rem; /* 4px */
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #e5e7eb; /* gray-200 */
        }
        .timeline-line-marker {
            position: absolute;
            left: 0.5rem;
            width: 1rem;
            height: 1rem;
            background-color: #10b981; /* emerald-500 */
            border-radius: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }
        /* 隱藏預設捲軸，僅限於桌面瀏覽器 */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="text-xl font-bold text-emerald-600">波蘭10日旅程</div>
                <div class="flex space-x-4">
                    <button class="nav-btn p-2 rounded-md hover:bg-emerald-50 text-emerald-600 font-medium transition duration-150" data-target="overview">行程總覽</button>
                    <button class="nav-btn p-2 rounded-md hover:bg-emerald-50 text-gray-600 font-medium transition duration-150" data-target="daily">每日行程</button>
                    <button class="nav-btn p-2 rounded-md hover:bg-emerald-50 text-gray-600 font-medium transition duration-150" data-target="food">美食地圖</button>
                    <button class="nav-btn p-2 rounded-md hover:bg-emerald-50 text-gray-600 font-medium transition duration-150" data-target="info">交通住宿</button>
                    <button class="nav-btn p-2 rounded-md hover:bg-emerald-50 text-gray-600 font-medium transition duration-150" data-target="prep">行前準備</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <section id="overview" class="page-section">
            <h2 class="text-3xl font-bold mb-6 text-emerald-700 border-b-2 border-emerald-300 pb-2">✈️ 行程總覽</h2>
            <div class="bg-white p-6 rounded-lg shadow-xl grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="p-4 bg-emerald-50 rounded-lg">
                    <p class="text-sm text-gray-500">日期</p>
                    <p class="text-xl font-semibold text-emerald-600">2/13 (五) → 2/22 (日)</p>
                </div>
                <div class="p-4 bg-emerald-50 rounded-lg">
                    <p class="text-sm text-gray-500">天數</p>
                    <p class="text-xl font-semibold text-emerald-600">10 天</p>
                </div>
                <div class="p-4 bg-emerald-50 rounded-lg">
                    <p class="text-sm text-gray-500">目的地</p>
                    <p class="text-xl font-semibold text-emerald-600">波蘭 (布達佩斯 → 克拉科夫 → 華沙)</p>
                </div>
                <div class="p-4 bg-emerald-50 rounded-lg">
                    <p class="text-sm text-gray-500">同行成員</p>
                    <p class="text-xl font-semibold text-emerald-600">徐先生 / 蔡小姐</p>
                </div>
            </div>

            <h3 class="text-2xl font-bold mt-10 mb-4 text-gray-700">城市間交通比較 (火車)</h3>
            <div class="bg-white p-6 rounded-lg shadow-xl">
                <canvas id="trafficChart" height="100"></canvas>
            </div>
            <p class="mt-4 text-sm text-gray-500">**圖表說明:** 比較布達佩斯 → 克拉科夫 (夜臥) 與 克拉科夫 → 華沙 (高鐵) 的旅行時間和預估費用。</p>
        </section>

        <hr class="my-10 border-gray-200">

        <section id="daily" class="page-section hidden">
            <h2 class="text-3xl font-bold mb-8 text-emerald-700 border-b-2 border-emerald-300 pb-2">📅 每日行程 (時間軸)</h2>

            <div id="itinerary-list" class="space-y-12">
                </div>
        </section>

        <hr class="my-10 border-gray-200">

        <section id="food" class="page-section hidden">
            <h2 class="text-3xl font-bold mb-6 text-emerald-700 border-b-2 border-emerald-300 pb-2">🍜 美食地圖</h2>
            <div class="flex space-x-3 mb-6">
                <button class="food-filter-btn px-4 py-2 rounded-full text-white bg-emerald-600 hover:bg-emerald-700 transition duration-150" data-filter="all">所有美食</button>
                <button class="food-filter-btn px-4 py-2 rounded-full text-gray-600 bg-gray-200 hover:bg-gray-300 transition duration-150" data-filter="local">當地美食</button>
                <button class="food-filter-btn px-4 py-2 rounded-full text-gray-600 bg-gray-200 hover:bg-gray-300 transition duration-150" data-filter="snack">特色小吃</button>
                <button class="food-filter-btn px-4 py-2 rounded-full text-gray-600 bg-gray-200 hover:bg-gray-300 transition duration-150" data-filter="dessert">咖啡/甜點</button>
            </div>
            
            <div id="food-list" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
        </section>

        <hr class="my-10 border-gray-200">

        <section id="info" class="page-section hidden">
            <h2 class="text-3xl font-bold mb-6 text-emerald-700 border-b-2 border-emerald-300 pb-2">🛏️ 交通住宿資訊</h2>
            
            <h3 class="text-2xl font-bold mb-4 text-gray-700">住宿資訊</h3>
            <div class="space-y-6">
                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <p class="text-lg font-semibold text-emerald-600">布達佩斯 (2/13 → 2/16): 七季公寓酒店</p>
                    <p class="text-gray-500">7 Seasons Apartments</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=7+Seasons+Apartments+Budapest" target="_blank" class="text-blue-500 hover:text-blue-700 underline text-sm">Google Maps 連結</a>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <p class="text-lg font-semibold text-emerald-600">克拉科夫 (2/17 → 2/20): PLANTONIA Aparthotel</p>
                    <p class="text-gray-500">PLANTONIA Aparthotel</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=PLANTONIA+Aparthotel+Krakow" target="_blank" class="text-blue-500 hover:text-blue-700 underline text-sm">Google Maps 連結</a>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <p class="text-lg font-semibold text-emerald-600">華沙 (2/20 → 2/22): GreenView Warsaw City Centre</p>
                    <p class="text-gray-500">Ogrodowa $\Omega$ invoice FV (參考地址: Ogrodowa 65)</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=GreenView+Warsaw+City+Centre+Ogrodowa+65" target="_blank" class="text-blue-500 hover:text-blue-700 underline text-sm">Google Maps 連結 (Ogrodowa 65)</a>
                </div>
            </div>

            <h3 class="text-2xl font-bold mt-8 mb-4 text-gray-700">交通資訊</h3>
            <div class="bg-white p-6 rounded-lg shadow-xl space-y-4">
                <p><span class="font-bold text-emerald-600">城市間：</span> 布達佩斯 → 克拉科夫：**夜臥火車 EN 476**；克拉科夫 → 華沙：**波蘭高鐵 (EIC/IC)**。</p>
                <p><span class="font-bold text-emerald-600">市區內：</span> 建議使用**當地輕軌 (Tram)** 或**公車**。可考慮購買**城市日票**。</p>
                <p class="text-sm text-gray-500">💡 建議在當地下載交通 App (如 Jakdojade/Google Maps) 以查詢即時班次。</p>
            </div>
        </section>

        <hr class="my-10 border-gray-200">

        <section id="prep" class="page-section hidden">
            <h2 class="text-3xl font-bold mb-6 text-emerald-700 border-b-2 border-emerald-300 pb-2">📝 行前準備清單</h2>
            <div class="bg-white p-6 rounded-lg shadow-xl">
                <ul id="checklist" class="space-y-2">
                    <li class="flex items-center space-x-2"><input type="checkbox" id="check-passport" class="rounded text-emerald-600 focus:ring-emerald-500"><label for="check-passport">護照、簽證、電子機票</label></li>
                    <li class="flex items-center space-x-2"><input type="checkbox" id="check-currency" class="rounded text-emerald-600 focus:ring-emerald-500"><label for="check-currency">歐元/波蘭幣 (PLN) 現金</label></li>
                    <li class="flex items-center space-x-2"><input type="checkbox" id="check-adaptor" class="rounded text-emerald-600 focus:ring-emerald-500"><label for="check-adaptor">歐規轉接頭 (Type E/C)</label></li>
                    <li class="flex items-center space-x-2"><input type="checkbox" id="check-coat" class="rounded text-emerald-600 focus:ring-emerald-500"><label for="check-coat">保暖衣物 (2月波蘭天氣寒冷)</label></li>
                    <li class="flex items-center space-x-2"><input type="checkbox" id="check-insurance" class="rounded text-emerald-600 focus:ring-emerald-500"><label for="check-insurance">旅遊保險文件</label></li>
                </ul>
                <p class="mt-4 text-sm text-gray-500">💡 點擊方框可標記已完成項目。</p>
            </div>
        </section>
        
    </main>

    <script>
        // --- 數據結構定義 (已更新為真實 Google Maps 查詢連結) ---

        const itineraryData = [
            // D1: 布達佩斯
            { date: '2/13 (五)', city: '布達佩斯', accommodations: '七季公寓酒店', items: [
                { time: '08:50', title: '抵達布達佩斯', type: 'Flight/Train', duration: '入住飯店', mapLink: 'https://www.google.com/maps/search/?api=1&query=7+Seasons+Apartments+Budapest', transport: '機場接駁/電車', notes: '七季公寓酒店 (7 Seasons Apartments)' },
                { time: '下午', title: '聖史蒂芬教堂 (St. Stephen\'s Basilica)', type: 'Sightseeing', duration: '1.5 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=St.+Stephen%27s+Basilica+Budapest', transport: '步行', notes: '登頂觀景' },
                { time: '傍晚', title: '多瑙河畔散步 (鎖鏈橋附近)', type: 'Leisure', duration: '1 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Sz%C3%A9chenyi+Chain+Bridge+Budapest', transport: '步行', notes: '欣賞夜景' }
            ]},
            // D2: 布達佩斯
            { date: '2/14 (六)', city: '布達佩斯', accommodations: '七季公寓酒店', items: [
                { time: '上午', title: '布達皇宮 (Buda Castle) & 漁人堡 (Fisherman\'s Bastion)', type: 'Sightseeing', duration: '3 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Fisherman%27s+Bastion+and+Buda+Castle', transport: '公車/步行', notes: '多瑙河景觀' },
                { time: '下午', title: '國會大廈 (Hungarian Parliament Building)', type: 'Sightseeing', duration: '2 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Hungarian+Parliament+Building', transport: '電車/步行', notes: '可考慮內部導覽' },
                { time: '晚上', title: '多瑙河夜遊', type: 'Activity', duration: '2 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Hungarian+Parliament+Building', transport: '步行', notes: '國會大廈夜景點' }
            ]},
            // D3: 布達佩斯
            { date: '2/15 (日)', city: '布達佩斯', accommodations: '七季公寓酒店', items: [
                { time: '上午', title: '英雄廣場 (Hősök tere) & 城市公園 (City Park)', type: 'Sightseeing', duration: '2 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Heroes%27+Square+and+City+Park+Budapest', transport: '地鐵' },
                { time: '下午', title: '塞切尼溫泉 (Széchenyi Thermal Bath)', type: 'Relaxation', duration: '3 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Sz%C3%A9chenyi+Thermal+Bath', transport: '地鐵', notes: '必去活動' },
                { time: '傍晚', title: '歌劇院周邊散步', type: 'Leisure', duration: '1 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Hungarian+State+Opera', transport: '地鐵/步行', notes: '匈牙利國家歌劇院' }
            ]},
            // D4: 布達佩斯 → 克拉科夫
            { date: '2/16 (一)', city: '布達佩斯 → 克拉科夫', accommodations: '夜臥火車 EN 476', items: [
                { time: '上午', title: '中央大市場 (Great Market Hall)', type: 'Shopping', duration: '2 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Great+Market+Hall+Budapest', transport: '電車/步行', notes: '採買禮物' },
                { time: '下午', title: '格雷特山觀景 (Gellért Hill)', type: 'Sightseeing', duration: '2 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Gell%C3%A9rt+Hill+Budapest', transport: '電車/步行', notes: '俯瞰城市全景' },
                { time: '晚間', title: '布達佩斯火車站 (Budapest Keleti) → 登車', type: 'Departure', duration: 'check-in', mapLink: 'https://www.google.com/maps/search/?api=1&query=Budapest+Keleti+railway+station', transport: '火車', notes: '20:00 發車 (推測)' }
            ]},
            // D5: 克拉科夫
            { date: '2/17 (二)', city: '克拉科夫', accommodations: 'PLANTONIA Aparthotel', items: [
                { time: '早上', title: '抵達克拉科夫 (Kraków Główny) → Check-in', type: 'Arrival', duration: 'Check-in', mapLink: 'https://www.google.com/maps/search/?api=1&query=PLANTONIA+Aparthotel+Krakow', transport: '火車', notes: 'PLANTONIA Aparthotel' },
                { time: '上午', title: '老城廣場 (Rynek Główny)', type: 'Sightseeing', duration: '1.5 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Main+Square+Krakow', transport: '電車/步行', notes: '歐洲最大中世紀廣場' },
                { time: '下午', title: '聖母教堂 (St. Mary\'s Basilica) & 織布會館 (Sukiennice)', type: 'Sightseeing/Shopping', duration: '2 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Main+Square+Krakow', transport: '步行', notes: '欣賞教堂號角' }
            ]},
            // D6: 克拉科夫
            { date: '2/18 (三)', city: '克拉科夫', accommodations: 'PLANTONIA Aparthotel', items: [
                { time: '上午', title: '瓦維爾城堡 (Wawel Castle) & 主教堂', type: 'Sightseeing', duration: '3 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Wawel+Royal+Castle+Krakow', transport: '步行', notes: '波蘭國寶' },
                { time: '下午', title: 'Kazimierz 猶太區散步', type: 'Sightseeing/Culture', duration: '2 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Kazimierz+Krakow', transport: '電車', notes: '電影《辛德勒的名單》場景' }
            ]},
            // D7: 克拉科夫
            { date: '2/19 (四)', city: '克拉科夫', accommodations: 'PLANTONIA Aparthotel', items: [
                { time: '整日', title: '奧斯威辛集中營 (Auschwitz-Birkenau)', type: 'Culture/History', duration: '8 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Auschwitz-Birkenau+Memorial+and+Museum', transport: '專屬巴士/火車 (建議參加當地一日遊)', notes: '深具意義的歷史行程' }
            ]},
            // D8: 克拉科夫 → 華沙
            { date: '2/20 (五)', city: '克拉科夫 → 華沙', accommodations: 'GreenView Warsaw City Centre', items: [
                { time: '早上', title: '搭火車前往華沙 (Warszawa Centralna) → 抵達', type: 'Transit', duration: '3.5 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Warszawa+Centralna+train+station', transport: '波蘭高鐵 (EIC/IC)', notes: '約 08:00 發車' },
                { time: '下午', title: '華沙老城區 (Stare Miasto)', type: 'Sightseeing', duration: '2 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Warsaw+Old+Town', transport: '電車/步行', notes: '從廢墟中重建的歷史遺產' },
                { time: '傍晚', title: '皇家城堡 (Royal Castle) & 美人魚雕像', type: 'Sightseeing', duration: '1.5 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Royal+Castle+in+Warsaw', transport: '步行' }
            ]},
            // D9: 華沙
            { date: '2/21 (六)', city: '華沙', accommodations: 'GreenView Warsaw City Centre', items: [
                { time: '上午', title: '華沙起義博物館 (Warsaw Rising Museum)', type: 'History', duration: '3 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Warsaw+Rising+Museum', transport: '電車', notes: '了解二戰華沙起義的歷史' },
                { time: '下午', title: 'Nowy Świat 購物街 & 美術館 (National Museum in Warsaw)', type: 'Shopping/Culture', duration: '3 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=National+Museum+in+Warsaw+and+Nowy+Swiat', transport: '電車/步行', notes: '華沙國家博物館' }
            ]},
            // D10: 華沙 → 離境
            { date: '2/22 (日)', city: '華沙 → 離境', accommodations: 'NA', items: [
                { time: '上午', title: '彈性時間', type: 'Leisure', duration: '3 hr', mapLink: 'https://www.google.com/maps/search/?api=1&query=Warsaw+Old+Town', transport: '步行', notes: '最後採買/咖啡 (老城區)' },
                { time: '傍晚', title: '前往機場 (WAW) → 離境', type: 'Departure', duration: 'Check-out', mapLink: 'https://www.google.com/maps/search/?api=1&query=Warsaw+Chopin+Airport+WAW', transport: '機場快線/計程車', notes: '華沙蕭邦機場 (WAW) 16:00 出發 (推算)' }
            ]},
        ];

        const foodData = [
            { name: 'Gulasch (匈牙利燉肉)', city: '布達佩斯', tag: 'local', mapLink: 'https://www.google.com/maps/search/?api=1&query=Gulasch+restaurant+Central+Market+Hall+Budapest', notes: '傳統匈牙利美食 (中央大市場 Central Market Hall 附近)' },
            { name: 'Kremówka Papieska (教皇奶油蛋糕)', city: '克拉科夫', tag: 'dessert', mapLink: 'https://www.google.com/maps/search/?api=1&query=Kremowka+near+Krakow+Main+Square', notes: '波蘭經典甜點，教皇最愛 (老城廣場附近)' },
            { name: 'Pierogi (波蘭餃子)', city: '克拉科夫', tag: 'local', mapLink: 'https://www.google.com/maps/search/?api=1&query=Pierogarnia+Krakowiacy', notes: '必吃！有鹹有甜 (推薦餐廳：Pierogarnia Krakowiacy)' },
            { name: 'Zapiekanka (波蘭開放式三明治)', city: '克拉科夫', tag: 'snack', mapLink: 'https://www.google.com/maps/search/?api=1&query=Zapiekanka+Plac+Nowy+Krakow', notes: '猶太區特色小吃 (Plac Nowy 圓環)' },
            { name: 'Pączki (波蘭甜甜圈)', city: '華沙', tag: 'dessert', mapLink: 'https://www.google.com/maps/search/?api=1&query=P%C4%85czki+Nowy+%C5%9Awiat+Warsaw', notes: '比美式甜甜圈更紮實，玫瑰醬口味經典 (Nowy Świat 附近)' },
            { name: 'Żurek (酸裸麥湯)', city: '華沙', tag: 'local', mapLink: 'https://www.google.com/maps/search/?api=1&query=Zurek+restaurant+Warsaw+Old+Town', notes: '傳統波蘭湯品，常以麵包碗盛裝 (老城區附近)' },
        ];


        // --- 核心函數 ---

        // 1. 導覽列切換邏輯
        document.querySelectorAll('.nav-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const targetId = e.target.dataset.target;
                
                // 隱藏所有區塊
                document.querySelectorAll('.page-section').forEach(section => {
                    section.classList.add('hidden');
                });
                // 顯示目標區塊
                document.getElementById(targetId).classList.remove('hidden');

                // 更新導覽列按鈕樣式
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('text-emerald-600', 'bg-emerald-50');
                    btn.classList.add('text-gray-600', 'bg-transparent');
                });
                e.target.classList.add('text-emerald-600', 'bg-emerald-50');
                e.target.classList.remove('text-gray-600', 'bg-transparent');
            });
        });

        // 2. 每日行程時間軸生成
        function renderItinerary() {
            const container = document.getElementById('itinerary-list');
            container.innerHTML = ''; // 清空舊內容

            itineraryData.forEach(day => {
                const dayHeader = `
                    <div class="bg-emerald-600 text-white p-4 rounded-t-lg shadow-md">
                        <h3 class="text-xl font-bold">${day.date} - ${day.city}</h3>
                        <p class="text-sm">住宿: ${day.accommodations}</p>
                    </div>
                    <div class="bg-white p-6 rounded-b-lg shadow-xl relative mt-[-1px]">
                        <div class="timeline-line"></div>
                        <div class="space-y-6 pt-2">
                            ${day.items.map(item => `
                                <div class="flex items-start relative pl-10">
                                    <div class="timeline-line-marker -ml-1"></div>
                                    <div class="flex-1">
                                        <p class="text-xs font-semibold text-emerald-500">${item.time} (${item.transport})</p>
                                        <h4 class="text-lg font-bold text-gray-800">${item.title.replace('→', '→')}</h4>
                                        <p class="text-sm text-gray-600 mb-1">${item.notes || ''} <span class="text-emerald-600 font-medium">| 建議停留: ${item.duration}</span></p>
                                        <a href="${item.mapLink}" target="_blank" class="text-blue-500 hover:text-blue-700 underline text-sm flex items-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0L6.343 16.657A8 8 0 1117.657 16.657z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                                            Google Maps 路線/地點
                                        </a>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.innerHTML += dayHeader;
            });
        }

        // 3. 美食地圖篩選邏輯
        function renderFoodList(filter = 'all') {
            const container = document.getElementById('food-list');
            container.innerHTML = '';
            
            const filteredData = filter === 'all' 
                ? foodData 
                : foodData.filter(food => food.tag === filter);

            filteredData.forEach(food => {
                const tagMap = {
                    'local': '當地美食',
                    'snack': '特色小吃',
                    'dessert': '咖啡/甜點'
                };
                const foodCard = `
                    <div class="bg-white p-5 rounded-lg shadow-lg border-t-4 border-emerald-400" data-tag="${food.tag}">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="text-xl font-bold text-gray-800">${food.name}</h4>
                            <span class="text-xs font-medium px-2 py-1 bg-emerald-100 text-emerald-800 rounded-full">${tagMap[food.tag]}</span>
                        </div>
                        <p class="text-sm text-gray-500 mb-2">城市: ${food.city}</p>
                        <p class="text-base text-gray-600 mb-3">推薦: ${food.notes}</p>
                        <a href="${food.mapLink}" target="_blank" class="text-blue-500 hover:text-blue-700 underline text-sm flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0L6.343 16.657A8 8 0 1117.657 16.657z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                            查看地圖位置
                        </a>
                    </div>
                `;
                container.innerHTML += foodCard;
            });
            
            // 篩選按鈕樣式更新
            document.querySelectorAll('.food-filter-btn').forEach(btn => {
                if (btn.dataset.filter === filter) {
                    btn.classList.remove('text-gray-600', 'bg-gray-200');
                    btn.classList.add('text-white', 'bg-emerald-600');
                } else {
                    btn.classList.add('text-gray-600', 'bg-gray-200');
                    btn.classList.remove('text-white', 'bg-emerald-600');
                }
            });
        }

        document.querySelectorAll('.food-filter-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                renderFoodList(e.target.dataset.filter);
            });
        });

        // 4. Chart.js 圖表初始化
        function initTrafficChart() {
            const ctx = document.getElementById('trafficChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['布達佩斯 → 克拉科夫 (夜臥火車)', '克拉科夫 → 華沙 (高鐵)'],
                    datasets: [
                        {
                            label: '旅行時間 (小時)',
                            data: [12, 3.5], // 12小時夜臥，3.5小時高鐵
                            backgroundColor: '#059669', // emerald-600
                            borderColor: '#047857', // emerald-700
                            borderWidth: 1,
                            yAxisID: 'y'
                        },
                        {
                            label: '預估費用 (歐元)',
                            data: [90, 40], // 90歐元夜臥票，40歐元高鐵票 (推估)
                            backgroundColor: '#34d399', // emerald-400
                            borderColor: '#10b981', // emerald-500
                            borderWidth: 1,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        if (context.datasetIndex === 0) {
                                            label += context.parsed.y + ' 小時';
                                        } else {
                                            label += context.parsed.y + ' 歐元';
                                        }
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: { display: true, text: '旅行時間 (小時)' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: { drawOnChartArea: false }, // 只畫左側網格
                            title: { display: true, text: '預估費用 (歐元)' }
                        }
                    }
                }
            });
        }
        
        // 5. 行前準備清單互動 (使用 localStorage 儲存狀態)
        function initChecklist() {
            const checklist = document.getElementById('checklist');
            const storedState = JSON.parse(localStorage.getItem('travelChecklist')) || {};

            checklist.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                const id = checkbox.id;
                // 載入儲存的狀態
                if (storedState[id]) {
                    checkbox.checked = true;
                }

                // 點擊儲存狀態
                checkbox.addEventListener('change', (e) => {
                    storedState[id] = e.target.checked;
                    localStorage.setItem('travelChecklist', JSON.stringify(storedState));
                });
            });
        }


        // --- 頁面啟動 ---
        document.addEventListener('DOMContentLoaded', () => {
            renderItinerary(); // 渲染每日行程
            renderFoodList('all'); // 渲染美食地圖 (預設顯示全部)
            initTrafficChart(); // 初始化圖表
            initChecklist(); // 初始化行前準備清單
            
            // 確保頁面啟動時顯示「行程總覽」並設定按鈕樣式
            document.getElementById('overview').classList.remove('hidden');
            document.querySelector('.nav-btn[data-target="overview"]').classList.add('text-emerald-600', 'bg-emerald-50');
            document.querySelector('.nav-btn[data-target="overview"]').classList.remove('text-gray-600', 'bg-transparent');
        });

    </script>
</body>
</html>