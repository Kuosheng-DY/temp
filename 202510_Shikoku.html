<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>【蔡麗娟專屬】瀨戶內海藝術與自然七日遊</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        /* Custom scrollbar styling for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #a78bfa; /* Violet-400 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-track {
            background-color: #f3f4f6; /* Gray-100 */
        }
        .timeline-dot {
            position: relative;
            z-index: 10;
        }
        /* Style for active navigation link */
        .nav-link.active {
            background-color: #f3e8ff; /* Purple-100 */
            color: #7c3aed; /* Purple-600 */
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">

    <script id="data-json" type="application/json">
    {
        "tripInfo": {
            "days": 7,
            "dates": "2025/10/08 - 2025/10/14",
            "members": "蔡麗娟",
            "style": "深度藝術、自然探索、大眾運輸優化"
        },
        "transportInfo": {
            "main": "JR 四國列車, 琴電, 渡輪/高速船, 當地巴士 (小豆島橄欖巴士)",
            "pass": "建議購買 All Shikoku Rail Pass (7日券) + 小豆島橄欖巴士一日券 + ICOCA/Suica",
            "costs": [
                {"label": "JR/電車 (預估)", "value": 18000, "color": "bg-purple-500"},
                {"label": "渡輪 (預估)", "value": 6000, "color": "bg-indigo-500"},
                {"label": "巴士/接駁 (預估)", "value": 3000, "color": "bg-blue-500"}
            ]
        },
        "accommodationInfo": [
            {"day": "Day 1-3 (10/08-10/10)", "location": "高松/Dormy Inn", "type": "商務溫泉飯店", "note": "高松車站周邊，方便往返德島與港口"},
            {"day": "Day 4 (10/11)", "location": "小豆島/海灣渡假村飯店", "type": "度假飯店", "note": "已確認坂手港接駁"},
            {"day": "Day 5-7 (10/12-10/14)", "location": "高松/Comfort Hotel Takamatsu", "type": "商務旅館", "note": "高松市區，方便市區購物與琴電交通"}
        ],
        "dailyItinerary": [
            {
                "day": 1,
                "date": "10/08 (三)",
                "title": "高松抵達與市區初探",
                "activities": [
                    {"time": "18:05", "description": "抵達高松機場 (TAK)", "duration": "1小時", "transport": "利木津巴士", "route": "機場 → 高松站 (約 45分)", "map": "https://www.google.com/maps/search/?api=1&query=高松空港+利木津バス"},
                    {"time": "19:30", "description": "辦理 Dormy Inn Check-in", "duration": "1小時", "transport": "步行", "route": "高松站 → 飯店", "map": "https://www.google.com/maps/search/?api=1&query=Dormy+Inn+高松"},
                    {"time": "20:30", "description": "晚餐：高松站周邊/商店街", "duration": "1小時 30分", "transport": "步行", "route": "高松站周邊", "map": "https://www.google.com/maps/search/?api=1&query=高松駅+周辺+晚餐"}
                ]
            },
            {
                "day": 2,
                "date": "10/09 (四)",
                "title": "直島藝術巡禮：地中美術館",
                "activities": [
                    {"time": "09:00", "description": "搭船往直島 (宮浦港)", "duration": "1小時", "transport": "渡輪", "route": "高松港 → 宮浦港", "map": "https://www.google.com/maps/search/?api=1&query=高松港+直島+渡輪"},
                    {"time": "10:30", "description": "直島：南瓜與宮浦港周邊藝術", "duration": "1小時", "transport": "步行", "route": "宮浦港周邊", "map": "https://www.google.com/maps/search/?api=1&query=直島+宮浦港+紅南瓜"},
                    {"time": "11:30", "description": "搭巴士往地中美術館區", "duration": "30分", "transport": "町營巴士/接駁車", "route": "宮浦港 → つつじ荘 → 地中美術館", "map": "https://www.google.com/maps/search/?api=1&query=直島+つつじ荘+バス+時刻表"},
                    {"time": "12:00", "description": "**地中美術館** (午餐於館內或周邊)", "duration": "3小時", "transport": "步行", "route": "地中美術館", "map": "https://www.google.com/maps/search/?api=1&query=地中美術館"},
                    {"time": "15:30", "description": "Benesse House Museum & 戶外藝術", "duration": "2小時", "transport": "免費接駁車/步行", "route": "つつじ荘周邊", "map": "https://www.google.com/maps/search/?api=1&query=Benesse+House+Museum"},
                    {"time": "18:00", "description": "搭船返回高松港", "duration": "1小時", "transport": "渡輪", "route": "宮浦港 → 高松港", "map": "https://www.google.com/maps/search/?api=1&query=直島+宮浦港+高松港+渡輪"}
                ]
            },
            {
                "day": 3,
                "date": "10/10 (五)",
                "title": "德島：鳴門漩渦與阿波舞之夜",
                "activities": [
                    {"time": "08:00", "description": "搭乘 JR 前往德島", "duration": "1小時 30分", "transport": "JR 特急渦潮號", "route": "高松站 → 德島站", "map": "https://www.google.com/maps/search/?api=1&query=JR高松駅+JR徳島駅"},
                    {"time": "10:00", "description": "德島站搭巴士前往鳴門公園", "duration": "1小時 30分", "transport": "德島巴士", "route": "德島站 → 鳴門公園", "map": "https://www.google.com/maps/search/?api=1&query=徳島駅+鳴門公園+バス+時刻表"},
                    {"time": "11:30", "description": "**鳴門漩渦觀潮船** (配合大潮時間)", "duration": "2小時", "transport": "觀光船", "route": "渦之道/觀潮船碼頭", "map": "https://www.google.com/maps/search/?api=1&query=鳴門渦潮+観潮船"},
                    {"time": "14:00", "description": "午餐：鳴門海鮮/鯛魚料理", "duration": "1小時 30分", "transport": "步行", "route": "鳴門公園周邊", "map": "https://www.google.com/maps/search/?api=1&query=鳴門公園+周邊+海鮮+餐廳"},
                    {"time": "16:00", "description": "返回德島站", "duration": "1小時 30分", "transport": "德島巴士", "route": "鳴門公園 → 德島站", "map": "https://www.google.com/maps/search/?api=1&query=鳴門公園+徳島駅+バス+時刻表"},
                    {"time": "18:30", "description": "**阿波舞會館** 觀賞表演與晚餐", "duration": "3小時", "transport": "步行", "route": "德島站附近", "map": "https://www.google.com/maps/search/?api=1&query=阿波おどり会館"},
                    {"time": "21:30", "description": "搭乘 JR 返回高松", "duration": "1小時 15分", "transport": "JR 列車", "route": "德島站 → 高松站", "map": "https://www.google.com/maps/search/?api=1&query=JR徳島駅+JR高松駅"}
                ]
            },
            {
                "day": 4,
                "date": "10/11 (六)",
                "title": "小豆島：橄欖巴士一日遊",
                "activities": [
                    {"time": "09:00", "description": "搭船往小豆島 (土庄港)", "duration": "1小時", "transport": "渡輪/高速船", "route": "高松港 → 土庄港", "map": "https://www.google.com/maps/search/?api=1&query=高松港+小豆島土庄港+渡輪"},
                    {"time": "11:00", "description": "**天使之路** (確認低潮時間)", "duration": "1小時 30分", "transport": "橄欖巴士/步行", "route": "土庄港 → 國際飯店前", "map": "https://www.google.com/maps/search/?api=1&query=小豆島+天使の散歩道"},
                    {"time": "12:30", "description": "午餐後前往寒霞溪", "duration": "1小時 30分", "transport": "橄欖巴士/轉乘", "route": "國際飯店前 → 土庄港 → 池田港 → 紅雲亭 (寒霞溪急行線)", "map": "https://www.google.com/maps/search/?api=1&query=小豆島+寒霞溪"},
                    {"time": "14:30", "description": "**寒霞溪** 纜車觀景", "duration": "2小時", "transport": "纜車/步行", "route": "紅雲亭", "map": "https://www.google.com/maps/search/?api=1&query=寒霞溪ロープウェイ+紅雲亭駅"},
                    {"time": "17:00", "description": "**小豆島橄欖公園** 拍照", "duration": "1小時 30分", "transport": "橄欖巴士", "route": "紅雲亭 → 橄欖公園口", "map": "https://www.google.com/maps/search/?api=1&query=小豆島オリーブ公園"},
                    {"time": "18:45", "description": "搭乘**坂手線**前往坂手港並搭乘接駁車", "duration": "30分", "transport": "橄欖巴士/接駁車", "route": "橄欖公園口 → **坂手港** (飯店接駁點) → 飯店 CHECKIN", "map": "https://www.google.com/maps/search/?api=1&query=小豆島+坂手港+ベイリゾートホテル"}
                ]
            },
            {
                "day": 5,
                "date": "10/12 (日)",
                "title": "回高松：栗林公園與換宿",
                "activities": [
                    {"time": "09:30", "description": "Check-out，搭接駁車往**坂手港**", "duration": "30分", "transport": "飯店接駁車", "route": "飯店 → 坂手港", "map": "https://www.google.com/maps/search/?api=1&query=小豆島+坂手港"},
                    {"time": "10:30", "description": "搭船返回高松港", "duration": "1小時 15分", "transport": "渡輪", "route": "**坂手港** → 高松港", "map": "https://www.google.com/maps/search/?api=1&query=小豆島坂手港+高松港+渡輪"},
                    {"time": "12:30", "description": "午餐後，Comfort Hotel Takamatsu CHECKIN", "duration": "1小時 30分", "transport": "步行", "route": "高松港 → 飯店", "map": "https://www.google.com/maps/search/?api=1&query=Comfort+Hotel+Takamatsu"},
                    {"time": "14:30", "description": "**栗林公園** 散步賞景", "duration": "2小時 30分", "transport": "JR/步行", "route": "高松站 → 栗林公園北口/栗林公園站", "map": "https://www.google.com/maps/search/?api=1&query=栗林公園"},
                    {"time": "18:00", "description": "高松丸龜町商店街購物與晚餐", "duration": "3小時", "transport": "步行", "route": "高松市中心", "map": "https://www.google.com/maps/search/?api=1&query=高松丸亀町商店街"}
                ]
            },
            {
                "day": 6,
                "date": "10/13 (一)",
                "title": "神聖之路：金刀比羅宮與溫泉",
                "activities": [
                    {"time": "09:00", "description": "搭乘琴電前往琴平", "duration": "1小時 30分", "transport": "琴電琴平線", "route": "高松築港站 → 琴電琴平站", "map": "https://www.google.com/maps/search/?api=1&query=高松築港駅+琴電琴平駅"},
                    {"time": "11:00", "description": "**金刀比羅宮** 參拜 (1368 級階梯)", "duration": "3小時", "transport": "步行", "route": "琴電琴平站 → 表參道", "map": "https://www.google.com/maps/search/?api=1&query=金刀比羅宮"},
                    {"time": "14:30", "description": "午餐：讚岐烏龍麵名店", "duration": "1小時 30分", "transport": "步行", "route": "琴平站周邊", "map": "https://www.google.com/maps/search/?api=1&query=琴平駅+烏龍麵"},
                    {"time": "16:30", "description": "琴平溫泉/足湯/散步", "duration": "1小時 30分", "transport": "步行", "route": "琴平溫泉街", "map": "https://www.google.com/maps/search/?api=1&query=琴平+温泉+足湯"},
                    {"time": "18:00", "description": "返回高松市區", "duration": "1小時 30分", "transport": "琴電琴平線", "route": "琴電琴平站 → 高松築港站", "map": "https://www.google.com/maps/search/?api=1&query=琴電琴平駅+高松築港駅"}
                ]
            },
            {
                "day": 7,
                "date": "10/14 (二)",
                "title": "賦歸日：高松市區購物",
                "activities": [
                    {"time": "09:00", "description": "高松市區自由購物", "duration": "6小時", "transport": "步行", "route": "丸龜町商店街/瓦町FLAG", "map": "https://www.google.com/maps/search/?api=1&query=高松丸亀町商店街"},
                    {"time": "15:00", "description": "回飯店整理行李", "duration": "1小時", "transport": "步行", "route": "Comfort Hotel Takamatsu", "map": "https://www.google.com/maps/search/?api=1&query=Comfort+Hotel+Takamatsu"},
                    {"time": "16:00", "description": "搭乘利木津巴士前往機場", "duration": "1小時 30分", "transport": "利木津巴士", "route": "高松站 → 機場 (約 45分)", "map": "https://www.google.com/maps/search/?api=1&query=高松駅+利木津バス+時刻表"},
                    {"time": "19:05", "description": "高松機場 (TAK) 登機賦歸", "duration": " - ", "transport": " - ", "route": " - ", "map": ""}
                ]
            }
        ],
        "restaurants": [
            {"name": "烏龍麵 鶴丸", "type": "烏龍麵", "map": "https://www.google.com/maps/search/?api=1&query=手打うどん+鶴丸", "location": "高松"},
            {"name": "麵處 めりけんや", "type": "烏龍麵 (車站)", "map": "https://www.google.com/maps/search/?api=1&query=麺処+めりけんや+高松", "location": "高松"},
            {"name": "さぬきうどん 本家 かもだ", "type": "烏龍麵 (琴平)", "map": "https://www.google.com/maps/search/?api=1&query=さぬきうどん+本家+かもだ", "location": "琴平"},
            {"name": "德島拉麵 豬太郎", "type": "當地小吃", "map": "https://www.google.com/maps/search/?api=1&query=いのたに+徳島ラーメン", "location": "德島"},
            {"name": "渦之道周邊海鮮店", "type": "海鮮/當地特色", "map": "https://www.google.com/maps/search/?api=1&query=鳴門公園+海鮮+餐廳", "location": "鳴門"},
            {"name": "こまめ食堂", "type": "當地特色/米飯", "map": "https://www.google.com/maps/search/?api=1&query=こまめ食堂+小豆島", "location": "小豆島"},
            {"name": "爐端燒 いけ田", "type": "海鮮/居酒屋", "map": "https://www.google.com/maps/search/?api=1&query=いけ田+高松", "location": "高松"}
        ]
    }
    </script>

    <header class="sticky top-0 z-50 shadow-md bg-white">
        <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0 text-xl font-extrabold text-purple-600">
                    瀨戶內七日遊
                </div>
                <div class="flex space-x-4">
                    <button class="nav-link text-gray-500 hover:text-purple-600 font-medium transition duration-150 ease-in-out px-3 py-2 rounded-md" data-target="overview">總覽</button>
                    <button class="nav-link text-gray-500 hover:text-purple-600 font-medium transition duration-150 ease-in-out px-3 py-2 rounded-md" data-target="transport-accommodations">交通住宿</button>
                    <button class="nav-link text-gray-500 hover:text-purple-600 font-medium transition duration-150 ease-in-out px-3 py-2 rounded-md" data-target="daily-itinerary">每日行程</button>
                    <button class="nav-link text-gray-500 hover:text-purple-600 font-medium transition duration-150 ease-in-out px-3 py-2 rounded-md" data-target="food-map">美食地圖</button>
                    <button class="nav-link text-gray-500 hover:text-purple-600 font-medium transition duration-150 ease-in-out px-3 py-2 rounded-md" data-target="preparation">行前準備</button>
                </div>
            </div>
        </nav>
    </header>

    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

        <section id="overview" class="content-section active">
            <h1 class="text-4xl font-bold text-gray-900 mb-6 border-b-4 border-purple-500 pb-2">🛫 行程總覽</h1>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 bg-white p-6 rounded-lg shadow-lg">
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <p class="text-sm text-gray-500">旅遊天數</p>
                    <p class="text-3xl font-extrabold text-purple-600" id="info-days"></p>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <p class="text-sm text-gray-500">旅遊日期</p>
                    <p class="text-xl font-bold text-purple-600" id="info-dates"></p>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <p class="text-sm text-gray-500">同行成員</p>
                    <p class="text-xl font-bold text-purple-600" id="info-members"></p>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <p class="text-sm text-gray-500">旅遊風格</p>
                    <p class="text-xl font-bold text-purple-600" id="info-style"></p>
                </div>
            </div>
            <div class="mt-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">🌟 行程亮點</h2>
                <ul class="list-disc pl-6 space-y-2 text-gray-700">
                    <li>**鳴門大漩渦：** 安排最佳觀潮時段，並利用 JR 往返德島與高松。</li>
                    <li>**小豆島高效一日遊：** 採用**橄欖巴士**與**坂手港接駁**，優化動線並在島上住宿一晚。</li>
                    <li>**直島藝術巡禮：** 專注地中美術館與戶外藝術，利用島上交通高效移動。</li>
                    <li>**高松文化探索：** 深度遊覽栗林公園、金刀比羅宮。</li>
                </ul>
            </div>
        </section>

        <section id="transport-accommodations" class="content-section hidden">
            <h1 class="text-4xl font-bold text-gray-900 mb-6 border-b-4 border-purple-500 pb-2">🚆 交通與住宿規劃</h1>

            <div class="bg-white p-6 rounded-lg shadow-lg mb-8">
                <h2 class="text-2xl font-semibold text-purple-700 mb-4">交通規劃與預算圖</h2>
                <p class="text-gray-700 mb-4 font-medium" id="transport-main"></p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <canvas id="transportChart"></canvas>
                        <p class="text-xs text-gray-500 mt-2 text-center">費用為預估每人總計，單位：日圓 (¥)</p>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">🎫 票券建議</h3>
                        <p class="text-sm text-gray-600 mb-4" id="transport-pass"></p>
                        <div class="space-y-3">
                            <div class="p-3 bg-red-100 border-l-4 border-red-500 text-red-800 rounded">
                                **注意：** 渡輪票（高松-小豆島/直島）**不包含**在任何鐵路通票內，需單獨購買。
                            </div>
                            <div class="p-3 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 rounded">
                                **重要：** 小豆島海灣渡假村飯店的坂手港接駁，請**務必提前預約**。
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-semibold text-purple-700 mb-4">🏠 住宿規劃</h2>
                <div class="space-y-4" id="accommodation-list">
                    </div>
            </div>
        </section>

        <section id="daily-itinerary" class="content-section hidden">
            <h1 class="text-4xl font-bold text-gray-900 mb-6 border-b-4 border-purple-500 pb-2">📅 每日行程 (Timeline)</h1>
            <div class="space-y-12" id="daily-timeline-container">
                </div>
        </section>

        <section id="food-map" class="content-section hidden">
            <h1 class="text-4xl font-bold text-gray-900 mb-6 border-b-4 border-purple-500 pb-2">🍜 美食地圖與推薦</h1>

            <div class="bg-white p-6 rounded-lg shadow-lg mb-8">
                <h2 class="text-2xl font-semibold text-purple-700 mb-4">篩選推薦餐廳</h2>
                <div class="flex flex-wrap gap-3 mb-4" id="restaurant-filters">
                    </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="restaurant-list">
                    </div>
            </div>
        </section>

        <section id="preparation" class="content-section hidden">
            <h1 class="text-4xl font-bold text-gray-900 mb-6 border-b-4 border-purple-500 pb-2">✅ 行前準備清單</h1>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h2 class="text-2xl font-semibold text-purple-700 mb-3">票券與預約</h2>
                    <ul class="list-disc pl-5 space-y-2 text-gray-700">
                        <li>**交通通票：** 確認是否購買 **All Shikoku Rail Pass**。</li>
                        <li>**小豆島：** 購買 **橄欖巴士一日券**。</li>
                        <li>**住宿接駁：** **務必預約**小豆島飯店的坂手港接駁車。</li>
                        <li>**直島：** **地中美術館** 門票建議提前線上預約。</li>
                        <li>**鳴門漩渦：** 查詢 10/10 **精確潮見表**，並配合船班時間，觀潮船票建議提早購買。</li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h2 class="text-2xl font-semibold text-purple-700 mb-3">必備物品與提醒</h2>
                    <ul class="list-disc pl-5 space-y-2 text-gray-700">
                        <li>**IC 卡：** 準備 ICOCA 或 Suica (儲值)，用於巴士和市區交通。</li>
                        <li>**交通APP：** 下載 Google Maps / Japan Travel Navitime，確認實時巴士與 JR 時刻表。</li>
                        <li>**直島/小豆島：** 需大量步行，準備舒適的鞋子。</li>
                        <li>**金刀比羅宮：** 準備毛巾和水，應對 1368 級階梯的挑戰。</li>
                        <li>**行李：** Day 3 晚上返回高松，可將大件行李寄存在高松的 Dormy Inn，輕裝上小豆島，減輕移動負擔。</li>
                    </ul>
                </div>
            </div>
        </section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const data = JSON.parse(document.getElementById('data-json').textContent);
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');

            // --- 1. 初始化導覽列與區塊切換 ---
            function showSection(targetId) {
                contentSections.forEach(section => {
                    section.classList.add('hidden');
                });
                document.getElementById(targetId).classList.remove('hidden');

                navLinks.forEach(link => {
                    link.classList.remove('active', 'text-purple-600', 'bg-purple-100');
                    link.classList.add('text-gray-500');
                    if (link.getAttribute('data-target') === targetId) {
                        link.classList.add('active', 'text-purple-600', 'bg-purple-100');
                        link.classList.remove('text-gray-500');
                    }
                });
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    const targetId = e.target.getAttribute('data-target');
                    showSection(targetId);
                });
            });

            // 預設顯示總覽
            showSection('overview');

            // --- 2. 渲染總覽資訊 ---
            document.getElementById('info-days').textContent = data.tripInfo.days + '天6夜';
            document.getElementById('info-dates').textContent = data.tripInfo.dates;
            document.getElementById('info-members').textContent = data.tripInfo.members;
            document.getElementById('info-style').textContent = data.tripInfo.style;
            
            // --- 3. 渲染交通與住宿區塊 ---
            document.getElementById('transport-main').textContent = data.transportInfo.main;
            document.getElementById('transport-pass').textContent = data.transportInfo.pass;

            // 渲染住宿列表
            const accommodationList = document.getElementById('accommodation-list');
            accommodationList.innerHTML = data.accommodationInfo.map(acc => `
                <div class="border-l-4 border-purple-500 pl-4 py-2 bg-gray-50 rounded">
                    <p class="font-bold text-gray-900">${acc.day}</p>
                    <p class="text-purple-600 font-medium">${acc.location} (${acc.type})</p>
                    <p class="text-sm text-gray-600">${acc.note}</p>
                </div>
            `).join('');

            // 使用 Chart.js 渲染交通費用圖表
            const ctx = document.getElementById('transportChart').getContext('2d');
            const costsData = data.transportInfo.costs;
            const labels = costsData.map(c => c.label);
            const values = costsData.map(c => c.value);
            // Convert Tailwind class to hex for Chart.js
            const colors = costsData.map(c => {
                const map = {'bg-purple-500': '#a855f7', 'bg-indigo-500': '#6366f1', 'bg-blue-500': '#3b82f6'};
                return map[c.color] || c.color;
            });

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '預估費用 (日圓)',
                        data: values,
                        backgroundColor: colors,
                        borderColor: colors.map(c => c),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ¥' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: '費用 (¥)' }
                        }
                    }
                }
            });

            // --- 4. 渲染每日行程時間軸 ---
            const timelineContainer = document.getElementById('daily-timeline-container');
            timelineContainer.innerHTML = data.dailyItinerary.map(dayData => `
                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <h2 class="text-3xl font-extrabold text-purple-600 mb-4 border-b pb-2">Day ${dayData.day}: ${dayData.title} <span class="text-xl text-gray-500 font-normal ml-2">(${dayData.date})</span></h2>
                    <div class="space-y-6 relative border-l-4 border-gray-200">
                        ${dayData.activities.map(activity => `
                            <div class="relative pl-10">
                                <div class="timeline-dot absolute w-4 h-4 bg-purple-500 rounded-full mt-1 -left-2 border-4 border-white"></div>
                                <p class="text-sm text-gray-500 font-semibold">${activity.time}</p>
                                <p class="text-lg font-bold text-gray-900 mb-1">${activity.description}</p>
                                <p class="text-sm text-gray-700">
                                    <span class="font-medium text-purple-700 mr-2">交通:</span> ${activity.transport} (約 ${activity.duration})
                                </p>
                                <p class="text-sm text-gray-700 mb-2">
                                    <span class="font-medium text-purple-700 mr-2">路線:</span> ${activity.route}
                                </p>
                                ${activity.map ? `<a href="${activity.map}" target="_blank" class="text-sm text-blue-500 hover:text-blue-700 hover:underline transition duration-150">查看 Google Maps</a>` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');


            // --- 5. 渲染美食地圖與篩選器 ---
            const restaurantList = document.getElementById('restaurant-list');
            const filterContainer = document.getElementById('restaurant-filters');
            let uniqueTypes = new Set();
            data.restaurants.forEach(r => uniqueTypes.add(r.type));

            // Generate filter buttons
            const allFilter = document.createElement('button');
            allFilter.textContent = '全部';
            allFilter.classList.add('filter-btn', 'px-4', 'py-2', 'rounded-full', 'font-medium', 'text-sm', 'bg-purple-600', 'text-white', 'hover:bg-purple-700', 'transition');
            allFilter.setAttribute('data-filter', 'all');
            filterContainer.appendChild(allFilter);

            uniqueTypes.forEach(type => {
                const button = document.createElement('button');
                button.textContent = type;
                button.classList.add('filter-btn', 'px-4', 'py-2', 'rounded-full', 'font-medium', 'text-sm', 'bg-gray-200', 'text-gray-700', 'hover:bg-purple-200', 'hover:text-purple-700', 'transition');
                button.setAttribute('data-filter', type);
                filterContainer.appendChild(button);
            });

            function renderRestaurants(filterType = 'all') {
                restaurantList.innerHTML = data.restaurants
                    .filter(r => filterType === 'all' || r.type === filterType)
                    .map(r => `
                        <div class="bg-purple-50 p-4 rounded-lg shadow">
                            <h3 class="text-xl font-bold text-gray-900">${r.name}</h3>
                            <p class="text-purple-600 font-medium my-1">${r.type} <span class="text-gray-500 text-sm">| ${r.location}</span></p>
                            <a href="${r.map}" target="_blank" class="text-sm text-blue-500 hover:text-blue-700 hover:underline transition duration-150 flex items-center mt-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
                                </svg>
                                點擊查看地圖
                            </a>
                        </div>
                    `).join('');
            }

            // 處理篩選器點擊事件
            filterContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('filter-btn')) {
                    const filter = e.target.getAttribute('data-filter');
                    
                    document.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.classList.remove('bg-purple-600', 'text-white');
                        btn.classList.add('bg-gray-200', 'text-gray-700');
                    });
                    
                    e.target.classList.remove('bg-gray-200', 'text-gray-700');
                    e.target.classList.add('bg-purple-600', 'text-white');

                    renderRestaurants(filter);
                }
            });

            // 初始渲染美食列表
            renderRestaurants('all');
        });
    </script>
</body>
</html>